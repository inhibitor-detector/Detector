import time
import RPi.GPIO as GPIO

pin_number = 8

GPIO.setmode(GPIO.BOARD)
GPIO.setup(pin_number, GPIO.OUT)

tone = GPIO.PWM(pin_number, 440)
volume = 99

# Define Tetris theme song notes and durations
A = 440
B = 494
C = 523
D = 587
E = 659

# tetris_notes = (
#     (E, 0.5), (B, 0.5), (C, 0.5), (D, 0.5), (C, 0.5), (B, 0.5), (A, 0.5), (A, 0.5),
#     (C, 0.5), (E, 0.5), (D, 0.5), (C, 0.5), (B, 0.5), (C, 0.5), (D, 0.5), (E, 0.5),
#     (C, 0.5), (A, 0.5), (A, 0.5), (A, 0.5), (A, 0.5), (B, 0.5), (C, 0.5), (D, 0.5),
#     (E, 0.5), (C, 0.5), (B, 0.5), (A, 0.5), (A, 0.5), (A, 0.5), (A, 0.5), (C, 0.5),
#     (E, 0.5), (D, 0.5), (C, 0.5), (B, 0.5), (C, 0.5), (D, 0.5), (E, 0.5), (C, 0.5),
#     (A, 0.5), (A, 0.5), (A, 0.5), (A, 0.5), (B, 0.5), (C, 0.5), (D, 0.5), (E, 0.5),
#     (C, 0.5), (B, 0.5), (A, 0.5)
# )


tetris_notes = [
    (659.25511, 0.40625), (493.8833, 0.203125), (523.25113, 0.203125), (587.32954, 0.40625), (523.25113, 0.203125), (493.8833, 0.203125), (440.0, 0.40625), (440.0, 0.203125), (523.25113, 0.203125), (659.25511, 0.40625), (587.32954, 0.203125), (523.25113, 0.203125), (493.8833, 0.609375), (523.25113, 0.203125), (587.32954, 0.40625), (659.25511, 0.40625), (523.25113, 0.40625), (440.0, 0.40625), (440.0, 0.203125), (440.0, 0.203125), (493.8833, 0.203125), (523.25113, 0.203125), (587.32954, 0.609375), (698.45646, 0.203125), (880.0, 0.40625), (783.99087, 0.203125), (698.45646, 0.203125), (659.25511, 0.609375), (523.25113, 0.203125), (659.25511, 0.40625), (587.32954, 0.203125), (523.25113, 0.203125), (493.8833, 0.40625), (493.8833, 0.203125), (523.25113, 0.203125), (587.32954, 0.40625), (659.25511, 0.40625), (523.25113, 0.40625), (440.0, 0.40625), (440.0, 0.40625)
]

star_wars = [
    (392.0, 0.5), (392.0, 0.5), (392.0, 0.5), (311.13, 0.35), (466.16, 0.15), (392.0, 0.5), (311.13, 0.35), (466.16, 0.15), (392.0, 1.0), (587.33, 0.5), (587.33, 0.5), (587.33, 0.5), (622.25, 0.35), (466.16, 0.15), (369.99, 0.5), (311.13, 0.35), (466.16, 0.15), (392.0, 1.0), (784.0, 0.5), (392.0, 0.35), (392.0, 0.15), (784.0, 1.0), (739.99, 0.5), (698.46, 0.35), (659.25, 0.15), (622.25, 1.0), (659.25, 0.5), (415.3, 0.35), (554.37, 0.15), (523.25, 1.0), (493.88, 0.5), (466.16, 0.35), (440.0, 0.15), (392.0, 1.0), (784.0, 0.5), (392.0, 0.35), (392.0, 0.15), (784.0, 1.0), (739.99, 0.5), (698.46, 0.35), (659.25, 0.15), (622.25, 1.0), (659.25, 0.5), (415.3, 0.375), (554.37, 0.125), (523.25, 1.0), (493.88, 0.5), (466.16, 0.375), (440.0, 0.125), (392.0, 1.0)
]



tone.start(volume)

def play_a_tone(freq, duration):
    if freq == 0:
        tone.ChangeDutyCycle(0)
        time.sleep(duration)
    else:
        tone.ChangeFrequency(freq)
        tone.ChangeDutyCycle(volume)
        time.sleep(duration)

def play_tetris_theme():
    for note, duration in star_wars:
        print("playing ", note)
        play_a_tone(note, duration)

try:
    play_tetris_theme()
finally:
    tone.stop()
    GPIO.cleanup()
